# TheZeroBetaRate
Code for "The Zero Beta Rate" (Di Tella, Hebert, Kurlat, Wang)

The below instructions will replicate the results of the paper.

NOTE: THE RESULTS WILL NOT BE IDENTICAL IN THE EVENT OF CRSP/COMPUSTAT CHANGES

	-The code requires a Wharton Research Data Services (WRDS) account with access to CRSP, Compustat, and "Bond Returns by WRDS."

	-The code will use your WRDS log-in to download CRSP and Compustat. These databases are updated periodically, and the version you download will not be identical to the version we downloaded when generating the results, although it should be very similar. As a result, the output will closely resemble, but not be exactly the same as, the numbers in our paper. If you need to perfectly replicate our numbers, please contact us.

Instructions:

1) Unzip archived data

 	a) cd to "TheZeroBetaRate" directory
 	b) cd to "Raw Data"
 	c) unzip Archive.zip
 
2) Run Python scripts to create dataset

	a) See README PYTHON.md for detailed instructions

3) Run MATLAB code to generate results

        a) Open MATLAB. tested with R2022a on an M1 Macbook pro and a Windows PC, known not to work on R2019b or earlier.
        
        b) cd to TheZeroBetaRate/MatlabCode
        
        c) run RunAll.m
        
        		i) this takes about 30m on an 2021 M1 Macbook Pro
		ii) when the parallel pool starts, you may be asked to allow Matlab to accept incoming connections. Allow this; the software should only use your local parallel pool unless you have specifically configured Matlab to do otherwise.
		
		iii) OPTIONAL: If you have the factors from the "Informative Factors" paper of  Amman, Hemauer, and Straumann, you can prepare that file and uncomment the associated code in RunAll.m. See the file for details.
        
        d) run MonetaryShock.m
        
        		i) this will run very quickly.
		ii) This will generate at Matlab warning about renaming column headers that can be ignored.
		
	e) run EquityAnalysis.m
		
		i) this will run very quickly. 
		ii) the figure and most of the results will be generated by setting "spec=0"
		iii) the numbers quoted in the text are called "sdnpv" and "sdnpv_tbill"
		iii) one number quoted in the text is generated from running the script with "spec=2" and results but no specific numbers from "spec=1" are mentioned in the text
		
	f) cd to TheZeroBetaRate/Model
	
	g) run monetary_shock_model.m
	
		i) this will run very quickly.
		
4) Run STATA to generate tables

	a) open Stata. Tested with Stata MP 17.0 and 18.0 on an M1 Macbook Pro and a Windows PC.
	
		i) depending on your Matlab and Stata versions, the dates in the intermediate .csv files might be "DMY" or "MDY" format
		   If you get Stata errors, trying changing the "DMY" formats to "MDY" in the Stata .do file
	
	b) cd to TheZeroBetaRate/StataCode
	
	c) do MakeTables.do
	
		i) this will run very quickly.
		
		ii) OPTIONAL: if you ran the "Informative Factors" code in RunAll.m, include the "InformativeFactors" specification in the "local specs ..." near the top of the .do file
		
5) Inspect output

	a) The output can be found in the "Output" folder
	
	b) To view the output as tables and figures, use LyX (tested with v2.3.6.2) to compile TablesAndFigures.lyx 



